# Построение модели прогнозирования оттока клиентов сети фитнес-центров


## Данные

#### Таблица gym_churn (данные на месяц до оттока и факт оттока на определённый месяц):

Данные клиента за предыдущий до проверки факта оттока месяц:
- 'gender' — пол;
- 'Near_Location' — проживание или работа в районе, где находится фитнес-центр;
- 'Partner' — сотрудник компании-партнёра клуба (сотрудничество с компаниями, чьи сотрудники могут получать скидки на абонемент — в таком случае фитнес-центр хранит информацию о работодателе клиента);
- Promo_friends — факт первоначальной записи в рамках акции «приведи друга» (использовал промо-код от знакомого при оплате первого абонемента);
- 'Phone' — наличие контактного телефона;
- 'Age' — возраст;
- 'Lifetime' — время с момента первого обращения в фитнес-центр (в месяцах)

Информация на основе журнала посещений, покупок и информация о текущем статусе абонемента клиента:
- 'Contract_period' — длительность текущего действующего абонемента (месяц, 6 месяцев, год);
- 'Month_to_end_contract' — срок до окончания текущего действующего абонемента (в месяцах);
- 'Group_visits' — факт посещения групповых занятий;
- 'Avg_class_frequency_total' — средняя частота посещений в неделю за все время с начала действия абонемента;
- 'Avg_class_frequency_current_month' — средняя частота посещений в неделю за предыдущий месяц;
- 'Avg_additional_charges_total' — суммарная выручка от других услуг фитнес-центра: кафе, спорттовары, косметический и массажный салон
- 'Churn' — факт оттока в текущем месяце

## Задачи

- Провести EDA 
- Построить модель бинарной классификации клиентов, где целевой признак — факт оттока клиента в следующем месяце:
- Разбить данные на обучающую и валидационную выборку функцией train_test_split().
- Обучить модель на train-выборке двумя способами:
логистической регрессией,
случайным лесом
- Оценить метрики accuracy, precision и recall для обеих моделей на валидационной выборке. Сравнить по ним модели
- Кластеризировать клиентов
- Стандартизировать данные
- Построить матрицу расстояний функцией linkage() на стандартизованной матрице признаков и нарисовать дендрограмму
- Обучить модель кластеризации на основании алгоритма K-Means и спрогнозировать кластеры клиентов
- Построить распределения признаков для кластеров
- Для каждого полученного кластера посчитать долю оттока (методом groupby())

## Используемые библиотеки
*pandas* *numpy* *scipy* *sklearn* *matplotlib* *seaborn* 
